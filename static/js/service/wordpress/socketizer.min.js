"use strict";var Socketizer=Socketizer||{};Socketizer.main=function(e){var t=false;var n="192.168.1.3:8080";var a="ws://"+n+"/service/wordpress/live/"+socketizer.host;var o={};o.attempts=1;var r={};r.connected=false;r.init=function(){o.healthyClose();o.check();o.connect()};o.healthyClose=function(){window.onbeforeunload=function(){if(r.connected){o.socket.close(1e3)}}};o.check=function(){if(window.WebSocket){t=true}else{r.connected="Socketizer: Please update to a modern web browser"}};o.connect=function(){if(t){o.socket=new WebSocket(a);o.socket.onopen=function(){r.connected=true};o.socket.onmessage=function(e){o.receive(e)};o.socket.onclose=function(){r.connected=false;o.close()}}};o.close=function(){var e=o.generateInterval(o.attempts);setTimeout(function(){o.attempts++;o.connect()},e)};o.generateInterval=function(e){var t=(Math.pow(2,e)-1)*1e3;if(t>30*1e3){t=30*1e3}return Math.random()*t};o.smallInterval=function(){var e=Math.random(1,1500);console.log("interval at: ",e);return e};o.receive=function(t){var n=JSON.parse(t.data);var a=socketizer.postsPage;var r=window.location.href;var i;if(n.hasOwnProperty("Data")){if(n.Data.hasOwnProperty("cmd")){if(n.Data.cmd==="refreshPost"){i=n.Data.postUrl;var c=n.Data.pageForPosts;var s=c.replace(/^https?:\/\//,"")===n.Data.host;var l="#post-"+n.Data.postId;var f=e(l).length===1;var u=false;if(n.Data.commentUrl!==""){u=true}if(u){r=r.split("#comment-")[0];if(i===r&&f){setTimeout(function(){e("#main").load(i+" #main > *")},o.smallInterval());return false}}else{if(i===r&&f){setTimeout(function(){e("#main").load(i+" #main > *")},o.smallInterval());return false}else if(r===a&&f){setTimeout(function(){e("#main").load(socketizer.postsPage+" #main > *")},o.smallInterval());return false}else if(s&&f){setTimeout(function(){e("#main").load(c+" #main > *")},o.smallInterval());return false}}}}}};return r}(jQuery);document.addEventListener("DOMContentLoaded",Socketizer.main.init);