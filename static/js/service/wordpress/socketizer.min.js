"use strict";var Socketizer=Socketizer||{};Socketizer.main=function(e){var t=false;var a="ws://service/wordpress/live/"+socketizer.host;var o={};o.attempts=1;var n={};n.connected=false;n.init=function(){o.healthyClose();o.check();o.connect()};o.healthyClose=function(){window.onbeforeunload=function(){if(n.connected){o.socket.close(1e3)}}};o.check=function(){if(window.WebSocket){t=true}else{n.connected="Socketizer: Please update to a modern web browser"}};o.connect=function(){if(t){o.socket=new WebSocket(a);o.socket.onopen=function(){n.connected=true};o.socket.onmessage=function(e){o.receive(e)};o.socket.onclose=function(){n.connected=false;o.close()}}};o.close=function(){var e=o.generateInterval(o.attempts);setTimeout(function(){o.attempts++;o.connect()},e)};o.generateInterval=function(e){var t=(Math.pow(2,e)-1)*1e3;if(t>30*1e3){t=30*1e3}return Math.random()*t};o.smallInterval=function(){return Math.random(1,1500)};o.receive=function(t){var a=JSON.parse(t.data);var n=socketizer.postsPage;var r=window.location.href;var s;if(a.hasOwnProperty("Data")){if(a.Data.hasOwnProperty("cmd")){if(a.Data.cmd==="refreshPost"){s=a.Data.postUrl;var i=a.Data.pageForPosts;var c=i.replace(/^https?:\/\//,"")===a.Data.host;var l="#post-"+a.Data.postId;var f=e(l).length===1;r=r.split("#comment-")[0];if(a.Data.what==="comment"){if(s===r&&f){setTimeout(function(){e("body").load(s)},o.smallInterval());return false}}else if(a.Data.what==="product"){l="#product-"+a.Data.postId;f=e(l).length===1;if(s===r&&f){setTimeout(function(){e("body").load(s)},o.smallInterval());return false}}else if(a.Data.what==="bb_reply"){if(s===r){setTimeout(function(){e("body").load(s)},o.smallInterval());return false}}else if(a.Data.what==="bb_topic"){if(s===r){setTimeout(function(){e("body").load(s)},o.smallInterval());return false}}else if(a.Data.what==="bb_forum"){console.log(a.Data.what);if(s===r){setTimeout(function(){e("body").load(s)},o.smallInterval());return false}}else if(a.Data.what==="post"){if(s===r&&f){setTimeout(function(){e("body").load(s)},o.smallInterval());return false}else if(r===n&&f){setTimeout(function(){e("body").load(socketizer.postsPage)},o.smallInterval());return false}else if(c&&f){setTimeout(function(){e("body").load(i)},o.smallInterval());return false}}}}}};return n}(jQuery);document.addEventListener("DOMContentLoaded",Socketizer.main.init);