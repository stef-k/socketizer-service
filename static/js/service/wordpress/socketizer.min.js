"use strict";var Socketizer=Socketizer||{};Socketizer.main=function(e){var t=false;var o="wss://service.socketizer.com/service/wordpress/live/"+socketizer.host;var a={};a.attempts=1;var n={};n.connected=false;n.init=function(){a.healthyClose();a.check();a.connect()};a.healthyClose=function(){window.onbeforeunload=function(){if(n.connected){a.socket.close(1e3)}}};a.check=function(){if(window.WebSocket){t=true}else{n.connected="Socketizer: Please update to a modern web browser"}};a.connect=function(){if(t){a.socket=new WebSocket(o);a.socket.onopen=function(){n.connected=true};a.socket.onmessage=function(e){a.receive(e)};a.socket.onclose=function(){n.connected=false;a.close()}}};a.close=function(){var e=a.generateInterval(a.attempts);setTimeout(function(){a.attempts++;a.connect()},e)};a.generateInterval=function(e){var t=(Math.pow(2,e)-1)*1e3;if(t>30*1e3){t=30*1e3}return Math.random()*t};a.smallInterval=function(){return Math.random(1,1500)};a.receive=function(t){var o=JSON.parse(t.data);var n=socketizer.postsPage;var r=window.location.href;var s;if(o.hasOwnProperty("Data")){if(o.Data.hasOwnProperty("cmd")){if(o.Data.cmd==="refreshPost"){s=o.Data.postUrl;var i=o.Data.pageForPosts;var c=i.replace(/^https?:\/\//,"")===o.Data.host;var l="#post-"+o.Data.postId;var f=e(l).length===1;r=r.split("#comment-")[0];if(o.Data.what==="comment"){if(s===r&&f){setTimeout(function(){e("body").load(s)},a.smallInterval());return false}}else if(o.Data.what==="product"){l="#product-"+o.Data.postId;f=e(l).length===1;if(s===r&&f){setTimeout(function(){e("body").load(s)},a.smallInterval());return false}}else if(o.Data.what==="bb_reply"){if(s===r){setTimeout(function(){e("body").load(s)},a.smallInterval());return false}}else if(o.Data.what==="bb_topic"){if(s===r){setTimeout(function(){e("body").load(s)},a.smallInterval());return false}}else if(o.Data.what==="bb_forum"){console.log(o.Data.what);if(s===r){setTimeout(function(){e("body").load(s)},a.smallInterval());return false}}else if(o.Data.what==="post"){if(s===r&&f){setTimeout(function(){e("body").load(s)},a.smallInterval());return false}else if(r===n&&f){setTimeout(function(){e("body").load(socketizer.postsPage)},a.smallInterval());return false}else if(c&&f){setTimeout(function(){e("body").load(i)},a.smallInterval());return false}}}}}};return n}(jQuery);document.addEventListener("DOMContentLoaded",Socketizer.main.init);