"use strict";var Socketizer=Socketizer||{};Socketizer.main=function(e){var t=false;var a="localhost:8080";var n="ws://"+a+"/service/live/"+socketizer.host;var o={};o.attempts=1;var r={};r.connected=false;r.init=function(){o.check();o.connect()};o.check=function(){if(window.WebSocket){t=true}else{r.connected="Socketizer: Please update to a modern web browser"}};o.connect=function(){if(t){o.socket=new WebSocket(n);o.socket.onopen=function(){r.connected=true};o.socket.onmessage=function(e){o.receive(e)};o.socket.onclose=function(){r.connected=false;o.close()}}};o.close=function(){var e=o.generateInterval(o.attempts);setTimeout(function(){o.attempts++;o.connect()},e)};o.generateInterval=function(e){var t=(Math.pow(2,e)-1)*1e3;if(t>30*1e3){t=30*1e3}return Math.random()*t};o.receive=function(t){var a=JSON.parse(t.data);var n=socketizer.postsPage;var o=window.location.href;var r;if(a.hasOwnProperty("Data")){if(a.Data.hasOwnProperty("cmd")){if(a.Data.cmd==="refreshPost"){r=a.Data.postUrl;var c=a.Data.pageForPosts;var i=c.replace(/^https?:\/\//,"")===a.Data.host;var s="#post-"+a.Data.postId;var f=e(s).length===1;if(r===o&&f){e("#main").load(r+" #main > *");return false}else if(o===n&&f){e("#main").load(socketizer.postsPage+" #main > *");return false}else if(i&&f){e("#main").load(c+" #main > *");return false}}}}};return r}(jQuery);document.addEventListener("DOMContentLoaded",Socketizer.main.init);