"use strict";var Socketizer=Socketizer||{};Socketizer.main=function(e){var t=false;var a="192.168.1.3:8080";var o="ws://"+a+"/service/wordpress/live/"+socketizer.host;var n={};n.attempts=1;var r={};r.connected=false;r.init=function(){n.healthyClose();n.check();n.connect()};n.healthyClose=function(){window.onbeforeunload=function(){if(r.connected){n.socket.close(1e3)}}};n.check=function(){if(window.WebSocket){t=true}else{r.connected="Socketizer: Please update to a modern web browser"}};n.connect=function(){if(t){n.socket=new WebSocket(o);n.socket.onopen=function(){r.connected=true};n.socket.onmessage=function(e){n.receive(e)};n.socket.onclose=function(){r.connected=false;n.close()}}};n.close=function(){var e=n.generateInterval(n.attempts);setTimeout(function(){n.attempts++;n.connect()},e)};n.generateInterval=function(e){var t=(Math.pow(2,e)-1)*1e3;if(t>30*1e3){t=30*1e3}return Math.random()*t};n.smallInterval=function(){return Math.random(1,1500)};n.receive=function(t){var a=JSON.parse(t.data);var o=socketizer.postsPage;var r=window.location.href;var s;if(a.hasOwnProperty("Data")){if(a.Data.hasOwnProperty("cmd")){if(a.Data.cmd==="refreshPost"){s=a.Data.postUrl;var i=a.Data.pageForPosts;var c=i.replace(/^https?:\/\//,"")===a.Data.host;var l="#post-"+a.Data.postId;var f=e(l).length===1;r=r.split("#comment-")[0];if(a.Data.what==="comment"){if(s===r&&f){setTimeout(function(){e("body").load(s)},n.smallInterval());return false}}else if(a.Data.what==="product"){l="#product-"+a.Data.postId;f=e(l).length===1;if(s===r&&f){setTimeout(function(){e("body").load(s)},n.smallInterval());return false}}else if(a.Data.what==="bb_reply"){if(s===r){setTimeout(function(){e("body").load(s)},n.smallInterval());return false}}else if(a.Data.what==="bb_topic"){if(s===r){setTimeout(function(){e("body").load(s)},n.smallInterval());return false}}else if(a.Data.what==="bb_forum"){console.log(a.Data.what);if(s===r){setTimeout(function(){e("body").load(s)},n.smallInterval());return false}}else if(a.Data.what==="post"){if(s===r&&f){setTimeout(function(){e("body").load(s)},n.smallInterval());return false}else if(r===o&&f){setTimeout(function(){e("body").load(socketizer.postsPage)},n.smallInterval());return false}else if(c&&f){setTimeout(function(){e("body").load(i)},n.smallInterval());return false}}}}}};return r}(jQuery);document.addEventListener("DOMContentLoaded",Socketizer.main.init);